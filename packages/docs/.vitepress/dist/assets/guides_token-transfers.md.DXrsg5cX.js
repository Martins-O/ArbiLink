import{_ as n,o as a,c as l,ag as p}from"./chunks/framework.DEqXEGcv.js";const b=JSON.parse('{"title":"Cross-Chain Token Transfers","description":"","frontmatter":{},"headers":[],"relativePath":"guides/token-transfers.md","filePath":"guides/token-transfers.md"}'),e={name:"guides/token-transfers.md"};function o(r,s,c,t,i,E){return a(),l("div",null,[...s[0]||(s[0]=[p(`<h1 id="cross-chain-token-transfers" tabindex="-1">Cross-Chain Token Transfers <a class="header-anchor" href="#cross-chain-token-transfers" aria-label="Permalink to &quot;Cross-Chain Token Transfers&quot;">​</a></h1><p>Send ERC-20 tokens from Arbitrum to any chain using ArbiLink.</p><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">​</a></h2><p>ArbiLink doesn&#39;t move tokens between chains — it moves <strong>instructions</strong>. The typical pattern is:</p><ol><li>Lock/burn tokens on Arbitrum</li><li>Send a message to the destination chain</li><li>The destination chain mints/releases the equivalent tokens</li></ol><h2 id="receiver-contract" tabindex="-1">Receiver Contract <a class="header-anchor" href="#receiver-contract" aria-label="Permalink to &quot;Receiver Contract&quot;">​</a></h2><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="color:#F97583;">pragma</span><span style="color:#85E89D;"> solidity</span><span style="color:#79B8FF;"> ^0.8.20</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#9ECBFF;"> &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;"> * </span><span style="color:#F97583;">@dev</span><span style="color:#6A737D;"> Wrapped token on destination chain.</span></span>
<span class="line"><span style="color:#6A737D;"> *      Only ArbiLinkReceiver can mint — enforcing the cross-chain supply.</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#F97583;">contract</span><span style="color:#B392F0;"> WrappedToken</span><span style="color:#F97583;"> is</span><span style="color:#B392F0;"> ERC20</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#F97583;"> public</span><span style="color:#F97583;"> immutable</span><span style="color:#E1E4E8;"> arbiLinkReceiver;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">    constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">address</span><span style="color:#E1E4E8;"> _receiver) </span><span style="color:#B392F0;">ERC20</span><span style="color:#E1E4E8;">(&quot;Wrapped USDC&quot;, &quot;wUSDC&quot;) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        arbiLinkReceiver </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> _receiver;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">    function</span><span style="color:#B392F0;"> mintCrossChain</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">address</span><span style="color:#FFAB70;"> to</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> amount</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">        require</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">msg.sender</span><span style="color:#F97583;"> ==</span><span style="color:#E1E4E8;"> arbiLinkReceiver, </span><span style="color:#9ECBFF;">&quot;Unauthorized&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">        _mint</span><span style="color:#E1E4E8;">(to, amount);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">    function</span><span style="color:#B392F0;"> burnCrossChain</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">address</span><span style="color:#FFAB70;"> from</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> amount</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">        require</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">msg.sender</span><span style="color:#F97583;"> ==</span><span style="color:#E1E4E8;"> arbiLinkReceiver, </span><span style="color:#9ECBFF;">&quot;Unauthorized&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#B392F0;">        _burn</span><span style="color:#E1E4E8;">(from, amount);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="sender-contract-arbitrum" tabindex="-1">Sender Contract (Arbitrum) <a class="header-anchor" href="#sender-contract-arbitrum" aria-label="Permalink to &quot;Sender Contract (Arbitrum)&quot;">​</a></h2><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="color:#F97583;">pragma</span><span style="color:#85E89D;"> solidity</span><span style="color:#79B8FF;"> ^0.8.20</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">interface</span><span style="color:#B392F0;"> IMessageHub</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    function</span><span style="color:#B392F0;"> send_message</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#79B8FF;">        uint256</span><span style="color:#FFAB70;"> chainId</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">        address</span><span style="color:#FFAB70;"> target</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">        bytes</span><span style="color:#F97583;"> calldata</span><span style="color:#FFAB70;"> data</span></span>
<span class="line"><span style="color:#E1E4E8;">    ) </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> payable</span><span style="color:#F97583;"> returns</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">uint256</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">contract</span><span style="color:#B392F0;"> TokenBridge</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    IMessageHub </span><span style="color:#F97583;">public</span><span style="color:#F97583;"> immutable</span><span style="color:#E1E4E8;"> hub;</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#F97583;">     public</span><span style="color:#F97583;"> immutable</span><span style="color:#E1E4E8;"> wrappedTokenOnBase;</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#F97583;">     public</span><span style="color:#F97583;"> constant</span><span style="color:#E1E4E8;">  BASE_SEPOLIA </span><span style="color:#F97583;">=</span><span style="color:#79B8FF;"> 84532</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">    event</span><span style="color:#B392F0;"> TokensLocked</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">address</span><span style="color:#F97583;"> indexed</span><span style="color:#FFAB70;"> user</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> amount</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> messageId</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">    constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">address</span><span style="color:#E1E4E8;"> _hub, </span><span style="color:#79B8FF;">address</span><span style="color:#E1E4E8;"> _wrappedToken) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        hub                </span><span style="color:#F97583;">=</span><span style="color:#B392F0;"> IMessageHub</span><span style="color:#E1E4E8;">(_hub);</span></span>
<span class="line"><span style="color:#E1E4E8;">        wrappedTokenOnBase </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> _wrappedToken;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">    function</span><span style="color:#B392F0;"> bridgeToBase</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> amount</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> payable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#6A737D;">        // 1. Lock tokens from sender</span></span>
<span class="line"><span style="color:#B392F0;">        IERC20</span><span style="color:#E1E4E8;">(USDC_ADDRESS).</span><span style="color:#B392F0;">transferFrom</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">msg.sender</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">address</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">), amount);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">        // 2. Encode mint call on Base</span></span>
<span class="line"><span style="color:#79B8FF;">        bytes</span><span style="color:#F97583;"> memory</span><span style="color:#E1E4E8;"> data </span><span style="color:#F97583;">=</span><span style="color:#79B8FF;"> abi</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">encodeWithSignature</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#9ECBFF;">            &quot;mintCrossChain(address,uint256)&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">            msg.sender</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">            amount</span></span>
<span class="line"><span style="color:#E1E4E8;">        );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">        // 3. Send cross-chain message</span></span>
<span class="line"><span style="color:#79B8FF;">        uint256</span><span style="color:#E1E4E8;"> messageId </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> hub.send_message{value</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> msg</span><span style="color:#E1E4E8;">.value}(</span></span>
<span class="line"><span style="color:#E1E4E8;">            BASE_SEPOLIA,</span></span>
<span class="line"><span style="color:#E1E4E8;">            wrappedTokenOnBase,</span></span>
<span class="line"><span style="color:#E1E4E8;">            data</span></span>
<span class="line"><span style="color:#E1E4E8;">        );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">        emit</span><span style="color:#B392F0;"> TokensLocked</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">msg.sender</span><span style="color:#E1E4E8;">, amount, messageId);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h2 id="sdk-usage" tabindex="-1">SDK Usage <a class="header-anchor" href="#sdk-usage" aria-label="Permalink to &quot;SDK Usage&quot;">​</a></h2><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { ArbiLink }           </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;@arbilink/sdk&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { encodeFunctionData } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;viem&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { parseUnits }         </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;ethers&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> WRAPPED_USDC_ON_BASE</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &#39;0xYourWrappedUSDCAddress&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> BASE_SEPOLIA</span><span style="color:#F97583;">         =</span><span style="color:#79B8FF;"> 84532</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> AMOUNT</span><span style="color:#F97583;">               =</span><span style="color:#B392F0;"> parseUnits</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;100&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// 100 USDC</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#F97583;"> function</span><span style="color:#B392F0;"> bridgeTokens</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">arbiLink</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> ArbiLink</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">recipient</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">  const</span><span style="color:#79B8FF;"> data</span><span style="color:#F97583;"> =</span><span style="color:#B392F0;"> encodeFunctionData</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    abi: [{</span></span>
<span class="line"><span style="color:#E1E4E8;">      name:   </span><span style="color:#9ECBFF;">&#39;mintCrossChain&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      type:   </span><span style="color:#9ECBFF;">&#39;function&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">      inputs: [</span></span>
<span class="line"><span style="color:#E1E4E8;">        { name: </span><span style="color:#9ECBFF;">&#39;to&#39;</span><span style="color:#E1E4E8;">,     type: </span><span style="color:#9ECBFF;">&#39;address&#39;</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">        { name: </span><span style="color:#9ECBFF;">&#39;amount&#39;</span><span style="color:#E1E4E8;">, type: </span><span style="color:#9ECBFF;">&#39;uint256&#39;</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">      ],</span></span>
<span class="line"><span style="color:#E1E4E8;">    }],</span></span>
<span class="line"><span style="color:#E1E4E8;">    functionName: </span><span style="color:#9ECBFF;">&#39;mintCrossChain&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    args: [recipient </span><span style="color:#F97583;">as</span><span style="color:#9ECBFF;"> \`0x\${</span><span style="color:#79B8FF;">string</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">AMOUNT</span><span style="color:#E1E4E8;">],</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">  const</span><span style="color:#79B8FF;"> messageId</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#E1E4E8;"> arbiLink.</span><span style="color:#B392F0;">sendMessage</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    chainId: </span><span style="color:#79B8FF;">BASE_SEPOLIA</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    target:  </span><span style="color:#79B8FF;">WRAPPED_USDC_ON_BASE</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    data,</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`Bridging 100 USDC to Base Sepolia — message #\${</span><span style="color:#E1E4E8;">messageId</span><span style="color:#9ECBFF;">}\`</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">  return</span><span style="color:#E1E4E8;"> messageId;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="full-round-trip-arbitrum-→-base-→-arbitrum" tabindex="-1">Full Round-Trip (Arbitrum → Base → Arbitrum) <a class="header-anchor" href="#full-round-trip-arbitrum-→-base-→-arbitrum" aria-label="Permalink to &quot;Full Round-Trip (Arbitrum → Base → Arbitrum)&quot;">​</a></h2><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// 1. Bridge Arbitrum → Base</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> toBase</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#B392F0;"> bridgeTokens</span><span style="color:#E1E4E8;">(arbiLink, user);</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#B392F0;"> waitForConfirmed</span><span style="color:#E1E4E8;">(arbiLink, toBase);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;100 USDC now on Base&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 2. Do something on Base</span></span>
<span class="line"><span style="color:#6A737D;">// ... use the tokens on Base ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// 3. Bridge back Base → Arbitrum (reverse message)</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> toArbitrum</span><span style="color:#F97583;"> =</span><span style="color:#F97583;"> await</span><span style="color:#B392F0;"> bridgeTokens</span><span style="color:#E1E4E8;">(baseArbiLink, user);</span></span>
<span class="line"><span style="color:#F97583;">await</span><span style="color:#B392F0;"> waitForConfirmed</span><span style="color:#E1E4E8;">(baseArbiLink, toArbitrum);</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;100 USDC back on Arbitrum&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#F97583;"> function</span><span style="color:#B392F0;"> waitForConfirmed</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">arbiLink</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> ArbiLink</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">messageId</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> bigint</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">  return</span><span style="color:#F97583;"> new</span><span style="color:#79B8FF;"> Promise</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">void</span><span style="color:#E1E4E8;">&gt;((</span><span style="color:#FFAB70;">resolve</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">reject</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    const</span><span style="color:#79B8FF;"> unsub</span><span style="color:#F97583;"> =</span><span style="color:#E1E4E8;"> arbiLink.</span><span style="color:#B392F0;">watchMessage</span><span style="color:#E1E4E8;">(messageId, (</span><span style="color:#FFAB70;">msg</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">      if</span><span style="color:#E1E4E8;"> (msg.status </span><span style="color:#F97583;">===</span><span style="color:#9ECBFF;"> &#39;confirmed&#39;</span><span style="color:#E1E4E8;">) { </span><span style="color:#B392F0;">unsub</span><span style="color:#E1E4E8;">(); </span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(); }</span></span>
<span class="line"><span style="color:#F97583;">      if</span><span style="color:#E1E4E8;"> (msg.status </span><span style="color:#F97583;">===</span><span style="color:#9ECBFF;"> &#39;failed&#39;</span><span style="color:#E1E4E8;">)    { </span><span style="color:#B392F0;">unsub</span><span style="color:#E1E4E8;">(); </span><span style="color:#B392F0;">reject</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> Error</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;Delivery failed&#39;</span><span style="color:#E1E4E8;">)); }</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div>`,13)])])}const F=n(e,[["render",o]]);export{b as __pageData,F as default};
