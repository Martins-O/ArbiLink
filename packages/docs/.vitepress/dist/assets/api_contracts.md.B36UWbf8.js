import{_ as e,o as a,c as n,ag as l}from"./chunks/framework.DEqXEGcv.js";const u=JSON.parse('{"title":"Smart Contracts","description":"","frontmatter":{},"headers":[],"relativePath":"api/contracts.md","filePath":"api/contracts.md"}'),t={name:"api/contracts.md"};function o(r,s,p,c,i,d){return a(),n("div",null,[...s[0]||(s[0]=[l(`<h1 id="smart-contracts" tabindex="-1">Smart Contracts <a class="header-anchor" href="#smart-contracts" aria-label="Permalink to &quot;Smart Contracts&quot;">​</a></h1><p>Reference for all ArbiLink smart contracts.</p><h2 id="messagehub-arbitrum-sepolia" tabindex="-1">MessageHub (Arbitrum Sepolia) <a class="header-anchor" href="#messagehub-arbitrum-sepolia" aria-label="Permalink to &quot;MessageHub (Arbitrum Sepolia)&quot;">​</a></h2><p>The core Rust/Stylus contract that manages messages, relayers, and chains.</p><p><strong>Address:</strong> <code>0x</code> <em>(see deployment-info.json after running <code>scripts/deploy.sh</code>)</em><strong>Chain:</strong> Arbitrum Sepolia (421614) <strong>Language:</strong> Rust (Arbitrum Stylus / WASM)</p><h3 id="functions" tabindex="-1">Functions <a class="header-anchor" href="#functions" aria-label="Permalink to &quot;Functions&quot;">​</a></h3><h4 id="send-message" tabindex="-1"><code>send_message</code> <a class="header-anchor" href="#send-message" aria-label="Permalink to &quot;\`send_message\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> send_message</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;"> chainId</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#FFAB70;"> target</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    bytes</span><span style="color:#F97583;">   calldata</span><span style="color:#FFAB70;"> data</span></span>
<span class="line"><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> payable</span><span style="color:#F97583;"> returns</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> messageId</span><span style="color:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Sends a cross-chain message. Emits <code>MessageSent</code>.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>chainId</code></td><td><code>uint256</code></td><td>Destination EVM chain ID</td></tr><tr><td><code>target</code></td><td><code>address</code></td><td>Target contract on destination chain</td></tr><tr><td><code>data</code></td><td><code>bytes</code></td><td>ABI-encoded call data</td></tr></tbody></table><p><strong>Value:</strong> Must be <code>≥ get_fee(chainId)</code>. Excess is refunded.</p><hr><h4 id="confirm-delivery" tabindex="-1"><code>confirm_delivery</code> <a class="header-anchor" href="#confirm-delivery" aria-label="Permalink to &quot;\`confirm_delivery\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> confirm_delivery</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> messageId</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Called by relayers to record successful delivery. Only callable by registered relayers.</p><hr><h4 id="challenge-message" tabindex="-1"><code>challenge_message</code> <a class="header-anchor" href="#challenge-message" aria-label="Permalink to &quot;\`challenge_message\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> challenge_message</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> messageId</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Challenge a claimed delivery. Callable by anyone during the 5-minute challenge window.</p><hr><h4 id="finalize-message" tabindex="-1"><code>finalize_message</code> <a class="header-anchor" href="#finalize-message" aria-label="Permalink to &quot;\`finalize_message\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> finalize_message</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> messageId</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Finalize a message after the challenge window. Releases relayer stake return.</p><hr><h4 id="get-fee" tabindex="-1"><code>get_fee</code> <a class="header-anchor" href="#get-fee" aria-label="Permalink to &quot;\`get_fee\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> get_fee</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> chainId</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> view</span><span style="color:#F97583;"> returns</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">uint256</span><span style="color:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Returns the current fee in wei to send to <code>chainId</code>.</p><hr><h4 id="get-message" tabindex="-1"><code>get_message</code> <a class="header-anchor" href="#get-message" aria-label="Permalink to &quot;\`get_message\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> get_message</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> messageId</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> view</span><span style="color:#F97583;"> returns</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#FFAB70;"> sender</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;"> destination</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#FFAB70;"> target</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    bytes</span><span style="color:#F97583;">   memory</span><span style="color:#FFAB70;"> data</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;"> value</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;"> fee</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;"> timestamp</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#FFAB70;"> relayer</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    uint8</span><span style="color:#FFAB70;">   status</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><hr><h4 id="register-relayer" tabindex="-1"><code>register_relayer</code> <a class="header-anchor" href="#register-relayer" aria-label="Permalink to &quot;\`register_relayer\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> register_relayer</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> payable</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Register as a relayer. Must send <code>RELAYER_STAKE</code> (0.1 ETH).</p><hr><h4 id="exit-relayer" tabindex="-1"><code>exit_relayer</code> <a class="header-anchor" href="#exit-relayer" aria-label="Permalink to &quot;\`exit_relayer\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> exit_relayer</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">external</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Deregister as a relayer. Stake returned after cooldown.</p><hr><h4 id="add-chain" tabindex="-1"><code>add_chain</code> <a class="header-anchor" href="#add-chain" aria-label="Permalink to &quot;\`add_chain\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> add_chain</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;"> chainId</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#FFAB70;"> receiver</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;"> fee</span></span>
<span class="line"><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Owner-only. Register a new destination chain.</p><hr><h3 id="constants" tabindex="-1">Constants <a class="header-anchor" href="#constants" aria-label="Permalink to &quot;Constants&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Constant</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td><code>RELAYER_STAKE</code></td><td>0.1 ETH</td><td>Minimum stake to become a relayer</td></tr><tr><td><code>CHALLENGE_WINDOW</code></td><td>300 seconds</td><td>Fraud-proof window after delivery claim</td></tr><tr><td><code>MAX_FEE</code></td><td>0.01 ETH</td><td>Maximum fee per message</td></tr></tbody></table><hr><h2 id="arbilinkreceiver-destination-chains" tabindex="-1">ArbiLinkReceiver (Destination Chains) <a class="header-anchor" href="#arbilinkreceiver-destination-chains" aria-label="Permalink to &quot;ArbiLinkReceiver (Destination Chains)&quot;">​</a></h2><p>Solidity contract deployed on each destination chain. Receives and executes messages.</p><p><strong>Language:</strong> Solidity ^0.8.20 <strong>Deployed on:</strong> Ethereum Sepolia, Base Sepolia</p><h3 id="key-functions" tabindex="-1">Key Functions <a class="header-anchor" href="#key-functions" aria-label="Permalink to &quot;Key Functions&quot;">​</a></h3><h4 id="receivemessage" tabindex="-1"><code>receiveMessage</code> <a class="header-anchor" href="#receivemessage" aria-label="Permalink to &quot;\`receiveMessage\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> receiveMessage</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;">        messageId</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#FFAB70;">        sender</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    bytes</span><span style="color:#F97583;"> calldata</span><span style="color:#FFAB70;"> data</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#FFAB70;">        target</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    bytes</span><span style="color:#F97583;"> calldata</span><span style="color:#FFAB70;"> executionProof</span></span>
<span class="line"><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> returns</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">bool</span><span style="color:#FFAB70;"> success</span><span style="color:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Called by relayers to deliver and execute a cross-chain message.</p><table tabindex="0"><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>messageId</code></td><td><code>uint256</code></td><td>Unique message ID from MessageHub</td></tr><tr><td><code>sender</code></td><td><code>address</code></td><td>Original sender on Arbitrum</td></tr><tr><td><code>data</code></td><td><code>bytes</code></td><td>ABI-encoded call to execute on <code>target</code></td></tr><tr><td><code>target</code></td><td><code>address</code></td><td>Contract to call</td></tr><tr><td><code>executionProof</code></td><td><code>bytes</code></td><td>ECDSA proof of valid delivery</td></tr></tbody></table><hr><h4 id="isprocessed" tabindex="-1"><code>isProcessed</code> <a class="header-anchor" href="#isprocessed" aria-label="Permalink to &quot;\`isProcessed\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> isProcessed</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> messageId</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> view</span><span style="color:#F97583;"> returns</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">bool</span><span style="color:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Returns <code>true</code> if a message has already been executed (replay protection).</p><hr><h4 id="getreceipt" tabindex="-1"><code>getReceipt</code> <a class="header-anchor" href="#getreceipt" aria-label="Permalink to &quot;\`getReceipt\`&quot;">​</a></h4><div class="language-solidity line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#B392F0;"> getReceipt</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">uint256</span><span style="color:#FFAB70;"> messageId</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">external</span><span style="color:#F97583;"> view</span><span style="color:#F97583;"> returns</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#79B8FF;">    bool</span><span style="color:#FFAB70;">    success</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    uint256</span><span style="color:#FFAB70;"> executedAt</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#79B8FF;">    address</span><span style="color:#FFAB70;"> executedBy</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Returns the execution receipt for a delivered message.</p><hr><h3 id="security" tabindex="-1">Security <a class="header-anchor" href="#security" aria-label="Permalink to &quot;Security&quot;">​</a></h3><ul><li><strong>Relayer allowlist</strong> — only approved relayers can call <code>receiveMessage</code></li><li><strong>Replay protection</strong> — <code>processedMessages[id]</code> mapping prevents re-execution</li><li><strong>ECDSA proof</strong> — every delivery requires a valid signature from the MessageHub</li><li><strong>CEI pattern</strong> — effects before interactions in all state-changing functions</li></ul><hr><h2 id="deployed-addresses" tabindex="-1">Deployed Addresses <a class="header-anchor" href="#deployed-addresses" aria-label="Permalink to &quot;Deployed Addresses&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Contract</th><th>Chain</th><th>Chain ID</th><th>Address</th></tr></thead><tbody><tr><td>MessageHub</td><td>Arbitrum Sepolia</td><td>421614</td><td><em>See deployment-info.json</em></td></tr><tr><td>ArbiLinkReceiver</td><td>Ethereum Sepolia</td><td>11155111</td><td><em>See deployment-info.json</em></td></tr><tr><td>ArbiLinkReceiver</td><td>Base Sepolia</td><td>84532</td><td><em>See deployment-info.json</em></td></tr></tbody></table><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Run <code>cat deployment-info.json</code> after deploying with <code>scripts/deploy.sh</code> to get all addresses.</p></div>`,69)])])}const b=e(t,[["render",o]]);export{u as __pageData,b as default};
